var w,container,carousel,item,radius,itemLength,rY,ticker,fps,swiper=new Swiper(".swiper",{slidesPerView:2,spaceBetween:0}),swiper2=new Swiper(".swiper-2",{slidesPerView:2,loop:!0,spaceBetween:0}),pause=(swiper=new Swiper(".swiper-container",{spaceBetween:20,slidesPerView:8,autoplay:{delay:200}}),!1),placed_elements=new Array,exportShapesMap=function(){if(pause)return 0;var s="";$(".wrapper .back-shapes img, .wrapper .back-shapes em").each(function(e){$(this).attr("src");var t=$(this).css("top"),a=$(this).css("left");t=100*parseInt(t)/window.innerHeight+"%",a=100*parseInt(a)/window.innerWidth+"%";var n=5*parseInt($(this).attr("data-ti"))/100;"IMG"==this.tagName?s+='<img src="'+$(this).attr("src")+'" class="floating" style="top:'+t+";left:"+a+";animation-delay:-"+n+'s;"/>\n':s+='<em class="'+$(this).attr("class")+'" style="top:'+t+";left:"+a+";animation-delay:-"+n+'s;"></em>\n'}),$("#shape-spawner-map").val(s)};$(".shape-spawner div img").click(function(){$(this).parent().find("img").each(function(){$(this).removeClass("active")}),$(this).parent().next().find("em").each(function(){$(this).removeClass("active")}),$(this).addClass("active")}),$(".shape-spawner div em").click(function(){$(this).parent().prev().find("img").each(function(){$(this).removeClass("active")}),$(this).parent().find("em").each(function(){$(this).removeClass("active")}),$(this).addClass("active")}),$(".wrapper").click(function(e){var t=e.pageX-$(this).offset().left,a=e.pageY-$(this).offset().top;placed_elements.push($(".shape-spawner div .active").clone().css({left:t-19.5,top:a-19.5}).addClass("floating").attr("data-ti",0).appendTo(".wrapper .back-shapes"));var n=placed_elements[placed_elements.length-1];n.css({left:100*parseInt(n.css("left"))/window.innerWidth+"%",top:100*parseInt(n.css("top"))/window.innerHeight+"%"})}),$("#export-map").click(function(){$("#shape-spawner-map").toggle(300)}),$("#pause-refleshing").click(function(){0==pause?(pause=!0,$(this).html("Resume map refleshing")):(pause=!1,$(this).html("Pause map refleshing"))}),$("#remove-last-placed").click(function(){$(placed_elements.pop()).remove()}),$("#remove-all").click(function(){placed_elements=new Array,$(".wrapper .back-shapes > *").each(function(){$(this).remove()})}),$("#icon-selector-show").click(function(){$(".icon-selector").toggle(300)}),$("#icon-selector-close").click(function(){$(this).parent().toggle(300)}),$(".icon-selector #selectable-icon").click(function(){$(".shape-spawner .active").removeClass("active"),$("#icon-placeholder > em").attr("class","active epic-icon "+$(this).attr("class"))}),setInterval(exportShapesMap,100),setInterval(function(){$(".wrapper .back-shapes img, .wrapper .back-shapes em").each(function(){var e=parseFloat($(this).attr("data-ti"));100==e?$(this).attr("data-ti","0"):$(this).attr("data-ti",e+1)})},50);var mouseX=0,mouseY=0,mouseZ=0,addX=0,fps_counter={tick:function(){this.times=this.times.concat(+new Date);var e,t=this.times;return t.length>this.span+1?(t.shift(),e=(t[t.length-1]-t[0])/1e3,Math.round(this.span/e)):null},times:[],span:20},counter=Object.create(fps_counter);function init(){w=$(window),container=$("#contentContainer"),carousel=$("#carouselContainer"),item=$(".carouselItem"),itemLength=$(".carouselItem").length,fps=$("#fps"),rY=360/itemLength,radius=Math.round(250/Math.tan(Math.PI/itemLength)),TweenMax.set(container,{perspective:5e3}),TweenMax.set(carousel,{z:-radius});for(var e=0;e<itemLength;e++){var t=item.eq(e),a=t.find(".carouselItemInner");TweenMax.set(t,{rotationY:rY*e,z:radius,transformOrigin:"50% 50% "+-radius+"px"}),animateIn(t,a)}window.addEventListener("mousemove",onMouseMove,!1),ticker=setInterval(looper,1e3/60)}function animateIn(e,t){getRandomInt(2);var a=360*getRandomInt(2),n=-2e3+getRandomInt(4e3),s=-2e3+getRandomInt(4e3),i=-4e3+getRandomInt(4e3),r=3.5+.1*getRandomInt(10),o=1-.1*getRandomInt(8);TweenMax.set(e,{autoAlpha:1,delay:o}),TweenMax.set(t,{z:i,rotationY:a,x:n,y:s,autoAlpha:0}),TweenMax.to(t,r,{delay:o,rotationY:0,z:0,ease:Expo.easeInOut}),TweenMax.to(t,r-.5,{delay:o,x:0,y:0,autoAlpha:1,ease:Expo.easeInOut})}function onMouseMove(e){mouseX=5e-4*-(-.5*window.innerWidth+e.pageX),mouseY=5e-4*-(-.5*window.innerHeight+e.pageY)}function looper(){addX+=mouseX,TweenMax.to(carousel,1,{rotationY:addX,ease:Quint.easeOut}),TweenMax.set(carousel,{z:mouseZ}),fps.text("Framerate: "+counter.tick()+"/60 FPS")}function getRandomInt(e){return Math.floor(Math.random()*e+1)}$(document).ready(init);